"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[55008],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>y});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),p=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(u.Provider,{value:t},e.children)},i="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,u=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),i=p(n),c=a,y=i["".concat(u,".").concat(c)]||i[c]||m[c]||l;return n?r.createElement(y,o(o({ref:t},d),{},{components:n})):r.createElement(y,o({ref:t},d))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=c;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[i]="string"==typeof e?e:a,o[1]=s;for(var p=2;p<l;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},66553:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>i,frontMatter:()=>l,metadata:()=>s,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const l={slug:"How-to-Install-and-Configure-MySQL-Cluster-on-CentOS-7"},o="How to Install and Configure MySQL Cluster on CentOS 7",s={unversionedId:"MySQL/Cluster/How to Install and Configure MySQL Cluster",id:"MySQL/Cluster/How to Install and Configure MySQL Cluster",title:"How to Install and Configure MySQL Cluster on CentOS 7",description:"link",source:"@site/docs/MySQL/Cluster/How to Install and Configure MySQL Cluster.md",sourceDirName:"MySQL/Cluster",slug:"/MySQL/Cluster/How-to-Install-and-Configure-MySQL-Cluster-on-CentOS-7",permalink:"/notebook/docs/MySQL/Cluster/How-to-Install-and-Configure-MySQL-Cluster-on-CentOS-7",draft:!1,editUrl:"https://github.com/scheffershen/notebook/tree/main/docs/MySQL/Cluster/How to Install and Configure MySQL Cluster.md",tags:[],version:"current",frontMatter:{slug:"How-to-Install-and-Configure-MySQL-Cluster-on-CentOS-7"},sidebar:"tutorialSidebar",previous:{title:"How To Create a Multi-Node MySQL Cluster on Ubuntu 16.04",permalink:"/notebook/docs/MySQL/Cluster/How-To-Create-a-Multi-Node-MySQL-Cluster-on-Ubuntu16"},next:{title:"bitnami-mysql_docker",permalink:"/notebook/docs/MySQL/Cluster/bitnami-mysql-replication-slave_docker"}},u={},p=[],d={toc:p};function i(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"how-to-install-and-configure-mysql-cluster-on-centos-7"},"How to Install and Configure MySQL Cluster on CentOS 7"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.howtoforge.com/tutorial/how-to-install-and-configure-mysql-cluster-on-centos-7/"},"link")),(0,a.kt)("p",null,"Prerequisites\nStep 1 - Setup Management Node\nA. Download the MySQL Cluster software\nB. Install and Remove Packages\nC. Install MySQL Cluster\nD. Configure MySQL Cluster\nE. Start the Management Node\nStep 2 - Setup the MySQL Cluster Data Nodes\nA. Login as root user and download the MySQL Cluster software\nB. Install and Remove Packages\nC. Install MySQL Cluster\nD. Configure Data Node\nE. Redo step 2.A - 2.D on db3 server.\nStep 3 - Setup SQL Node\nA. Log in and Download MySQL Cluster\nB. Install and Remove Packages\nC. Install MySQL Cluster\nD. Configure the SQL Node\nE. Redo step 3.A - 3.D on db5 server.\nStep 4 - Monitor the Cluster\nStep 5 - Testing the Cluster\nConclusion"),(0,a.kt)("p",null,"The MySQL Cluster technology is implemented through the NDB (Network DataBase) and NDBCLUSTER storage engines and provides shared-nothing clustering and auto-sharding for MySQL database systems."),(0,a.kt)("p",null,"To implement a MySQL Cluster, we have to install three types of nodes. Each node type will be installed on it's own server. The components are:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Management Node - NDB_MGMD/MGM\nThe Cluster management server is used to manage the other node of the cluster. We can create and configure new nodes, restart, delete, or backup nodes on the cluster from the management node.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Data Nodes - NDBD/NDB\nThis is the layer where the process of synchronizing and data replication between nodes happens.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"SQL Nodes - MySQLD/API\nThe interface servers that are used by the applications to connect to the database cluster."))),(0,a.kt)("p",null,"##Prerequisites    "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The OS is CentOS 7 - 64bit."),(0,a.kt)("li",{parentName:"ul"},"5 CentOS servers or virtual machines. I will use the hostnames and IP addresses as shown below:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Management Node\ndb1 = 192.168.1.120"),(0,a.kt)("li",{parentName:"ul"},"Data Nodes\ndb2 = 192.168.1.121\ndb3 = 192.168.1.122"),(0,a.kt)("li",{parentName:"ul"},"SQL Nodes\ndb4 = 192.168.1.123\ndb5 = 192.168.1.124")),(0,a.kt)("p",null,"##Step 1 - Setup Management Node"),(0,a.kt)("p",null,'The first step is to create the "Management Node" with CentOS 7 db1 and IP 192.168.1.120. Make sure you are logged into the db1 server as root user.'),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"A. Download the MySQL Cluster software")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# cd ~\n# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n# tar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"B. Install and Remove Packages")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# yum -y install perl-Data-Dumper\n# yum -y remove mariadb-libs\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"C. Install MySQL Cluster")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# cd ~\n# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"D. Configure MySQL Cluster")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# mkdir -p /var/lib/mysql-cluster\n# cd /var/lib/mysql-cluster\n# vi config.ini\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-config.ini"},"[ndb_mgmd default]\n# Directory for MGM node log files\nDataDir=/var/lib/mysql-cluster\n \n[ndb_mgmd]\n#Management Node db1\nHostName=192.168.1.120\n \n[ndbd default]\nNoOfReplicas=2      # Number of replicas\nDataMemory=256M     # Memory allocate for data storage\nIndexMemory=128M    # Memory allocate for index storage\n#Directory for Data Node\nDataDir=/var/lib/mysql-cluster\n \n[ndbd]\n#Data Node db2\nHostName=192.168.1.121\n\n[ndbd]\n#Data Node db3\nHostName=192.168.1.122\n \n[mysqld]\n#SQL Node db4\nHostName=192.168.1.123\n \n[mysqld]\n#SQL Node db5\nHostName=192.168.1.124\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"E. Start the Management Node")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ndb_mgmd --config-file=/var/lib/mysql-cluster/config.ini\n")),(0,a.kt)("p",null,'The management node is started, now you can use command "ndb_mgm" to monitor the node:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ndb_mgm\n    > show\n")),(0,a.kt)("p",null,"##Step 2 - Setup the MySQL Cluster Data Nodes"),(0,a.kt)("p",null,"We will use 2 CentOS servers for the Data Nodes."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"db2 = 192.168.1.121"),(0,a.kt)("li",{parentName:"ul"},"db3 = 192.168.1.122")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"A. Login as root user and download the MySQL Cluster software")),(0,a.kt)("p",null,"Login to the db2 server with ssh:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ssh root@192.168.1.121\n")),(0,a.kt)("p",null,"Then download the MySQL Cluster package and extract it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# cd ~\n# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n# tar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"B. Install and Remove Packages")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# yum -y install perl-Data-Dumper\n# yum -y remove mariadb-libs\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"C. Install MySQL Cluster")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# cd ~\n# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm    \n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"D. Configure Data Node")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# vi /etc/my.cnf\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-my.cnf"},"[mysqld]\nndbcluster\nndb-connectstring=192.168.1.120     # IP address of Management Node\n \n[mysql_cluster]\nndb-connectstring=192.168.1.120     # IP address of Management Node\n")),(0,a.kt)("p",null,'Then create the new directory for the database data that we defined in the management node config file "config.ini".'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# mkdir -p /var/lib/mysql-cluster\n")),(0,a.kt)("p",null,"Now start the data node/ndbd:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ndbd\n")),(0,a.kt)("p",null,"##Step 3 - Setup SQL Node"),(0,a.kt)("p",null,"This is step contains the setup for the SQL Node that provides the application access to the database."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"A. Log in and Download MySQL Cluster")),(0,a.kt)("p",null,"Login to the db4 server as root user:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ssh root@192.168.1.123\n\n# cd ~\n# wget http://dev.mysql.com/get/Downloads/MySQL-Cluster-7.4/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n# tar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"B. Install and Remove Packages")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# yum -y install perl-Data-Dumper\n# yum -y remove mariadb-libs  \n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"C. Install MySQL Cluster")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# cd ~\n# rpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\n# rpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"D. Configure the SQL Node")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# vi /etc/my.cnf\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-my.cnf"},"[mysqld]\nndbcluster\nndb-connectstring=192.168.1.120       # IP address for server management node\ndefault_storage_engine=ndbcluster     # Define default Storage Engine used by MySQL\n \n[mysql_cluster]\nndb-connectstring=192.168.1.120       # IP address for server management node\n")),(0,a.kt)("p",null,"Start the SQL Node by starting the MySQL server:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# service mysql start\n")),(0,a.kt)("p",null,"##Step 4 - Monitor the Cluster"),(0,a.kt)("p",null,"To see the cluster status, we have to log into the management node db1."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ssh root@192.168.1.120\n")),(0,a.kt)("p",null,"We can use the ndb_mgm command to see the cluster status:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ndb_mgm\n    > show\n")),(0,a.kt)("p",null,"Another useful command is:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'# ndb_mgm -e "all status"\n# ndb_mgm -e "all report memory"\n')),(0,a.kt)("p",null,"##Conclusion"),(0,a.kt)("p",null,"MySQL Cluster is a technology that provides High Availability and Redundancy for MySQL databases. It uses NDB or NDBCLUSTER as the storage engine and provides shared-nothing clustering and auto-sharding for MySQL databases.  To implement the cluster, we need 3 components: Management Node(MGM), Data Nodes (NDB) and SQL Nodes (API). Each of node must have its own memory and disk. It is not recommended to use network storage such as NFS. To install MySQL Cluster on a CentOS 7 minimal system, we have to remove the mariadb-libs package, mariadb-libs conflict with MySQL-Cluster-server and you have to install the perl-Data-Dumper package, it's needed by MySQL-Cluster-server. A MySQL Cluster is easy to install and configure on multiple CentOS servers."))}i.isMDXComponent=!0}}]);