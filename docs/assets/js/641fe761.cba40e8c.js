"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[28417],{3905:(e,r,t)=>{t.d(r,{Zo:()=>l,kt:()=>v});var o=t(67294);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function a(e,r){if(null==e)return{};var t,o,n=function(e,r){if(null==e)return{};var t,o,n={},s=Object.keys(e);for(o=0;o<s.length;o++)t=s[o],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)t=s[o],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var p=o.createContext({}),u=function(e){var r=o.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},l=function(e){var r=u(e.components);return o.createElement(p.Provider,{value:r},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var r=e.children;return o.createElement(o.Fragment,{},r)}},m=o.forwardRef((function(e,r){var t=e.components,n=e.mdxType,s=e.originalType,p=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),d=u(t),m=n,v=d["".concat(p,".").concat(m)]||d[m]||c[m]||s;return t?o.createElement(v,i(i({ref:r},l),{},{components:t})):o.createElement(v,i({ref:r},l))}));function v(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var s=t.length,i=new Array(s);i[0]=m;var a={};for(var p in r)hasOwnProperty.call(r,p)&&(a[p]=r[p]);a.originalType=e,a[d]="string"==typeof e?e:n,i[1]=a;for(var u=2;u<s;u++)i[u]=t[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},18493:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>u});var o=t(87462),n=(t(67294),t(3905));const s={},i="Supervisord, or How I Learned to Stop Worrying and\u2026 um\u2026 Use Supervisord",a={unversionedId:"Supervisor/Supervisord, Learned to Stop Worrying",id:"Supervisor/Supervisord, Learned to Stop Worrying",title:"Supervisord, or How I Learned to Stop Worrying and\u2026 um\u2026 Use Supervisord",description:"https://bixly.com/blog/supervisord-or-how-i-learned-to-stop-worrying-and-um-use-supervisord",source:"@site/docs/Supervisor/Supervisord, Learned to Stop Worrying.md",sourceDirName:"Supervisor",slug:"/Supervisor/Supervisord, Learned to Stop Worrying",permalink:"/notebook/docs/Supervisor/Supervisord, Learned to Stop Worrying",draft:!1,editUrl:"https://github.com/scheffershen/notebook/tree/main/docs/Supervisor/Supervisord, Learned to Stop Worrying.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"How To Install and Manage Supervisor on Ubuntu and Debian VPS",permalink:"/notebook/docs/Supervisor/How To Install and Manage Supervisor on Ubuntu"},next:{title:"docker-supervisor-php-workers",permalink:"/notebook/docs/Supervisor/docker-supervisor-php-workers"}},p={},u=[{value:"Initial setup",id:"initial-setup",level:2},{value:"Configuring our first program",id:"configuring-our-first-program",level:2},{value:"Configuring daemons",id:"configuring-daemons",level:2}],l={toc:u};function d(e){let{components:r,...t}=e;return(0,n.kt)("wrapper",(0,o.Z)({},l,t,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"supervisord-or-how-i-learned-to-stop-worrying-and-um-use-supervisord"},"Supervisord, or How I Learned to Stop Worrying and\u2026 um\u2026 Use Supervisord"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://bixly.com/blog/supervisord-or-how-i-learned-to-stop-worrying-and-um-use-supervisord"},"https://bixly.com/blog/supervisord-or-how-i-learned-to-stop-worrying-and-um-use-supervisord")),(0,n.kt)("p",null,"Date: May 25, 2016"),(0,n.kt)("p",null,"Supervisord is a nifty daemon for running and monitoring processes,"),(0,n.kt)("h2",{id:"initial-setup"},"Initial setup"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"$ apt-get install supervisor\n")),(0,n.kt)("p",null,"edit the supervisord configuration file (/etc/supervisor/supervisor.conf)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"[inet_http_server]\nport=9001\n")),(0,n.kt)("p",null,"restart supervisord by running"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"$ supervisorctl reload\n")),(0,n.kt)("p",null,"Point your browser to http://localhost:9001/ and you will see your supervisor console"),(0,n.kt)("p",null,"Lets create a group, add ourselves to it by doing the following"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"$ groupadd supervisor\n$ usermod -a -G supervisor vagrant\n")),(0,n.kt)("p",null,"edit the supervisord configuration file to make the unix_http_server section look as follows"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"[unix_http_server]\nfile=/var/run/supervisor.sock   ; (the path to the socket file)\nchmod=0770                       ; socket file mode (default 0700)\nchown=root:supervisor\n")),(0,n.kt)("h2",{id:"configuring-our-first-program"},"Configuring our first program"),(0,n.kt)("p",null,"Supervisord uses \u201cprogram\u201d as a naming convention for services it is setup to handle. Supervisor allows us to configure programs that run as background services, and will restart them upon failures. "),(0,n.kt)("p",null,"We can also create one-shot programs that do not need to run in the background as services."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"[program:uwsgi_app]\ncommand=/path/to/uwsgi --emperor /path/to/app/uwsgi.ini\nredirect_stderr=true\nstdout_logfile=/path/to/log\nstderr_logfile=/path/to/error_log\nuser=<myusername>\nautostart=false\nautorestart=true\nstopsignal=QUIT\n")),(0,n.kt)("p",null,"you will be able to start or stop the application by issuing the following command"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"supervisorctl [start|stop] uwsgi_app\n")),(0,n.kt)("h2",{id:"configuring-daemons"},"Configuring daemons"),(0,n.kt)("p",null,"Many of these applications leave a pidfile in /var/run, and we can couple these files with pidproxy, for services such as mysqld ( /etc/supervisor/conf.d/mysql.conf )"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'[program:mysql]\ncommand=/usr/bin/pidproxy /var/run/mysqld/mysqld.pid /usr/sbin/supervised_mysql\nredirect_stderr=true\nstdout_logfile=/var/log/mysql/supervisor.log\nstderr_logfile=/var/log/mysql/supervisor.error_log\nautostart=false\nautorestart=false\nenvironment=HOME="/etc/mysql"\numask=007\n')))}d.isMDXComponent=!0}}]);