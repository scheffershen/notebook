"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[97034],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>d});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var i=n.createContext({}),c=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},l=function(e){var t=c(e.components);return n.createElement(i.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),u=c(r),m=o,d=u["".concat(i,".").concat(m)]||u[m]||h[m]||a;return r?n.createElement(d,s(s({ref:t},l),{},{components:r})):n.createElement(d,s({ref:t},l))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,s=new Array(a);s[0]=m;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p[u]="string"==typeof e?e:o,s[1]=p;for(var c=2;c<a;c++)s[c]=r[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},47045:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var n=r(87462),o=(r(67294),r(3905));const a={},s="switcher apache vers l'autre port",p={unversionedId:"apache/configuration/switcher apache vers l autre port",id:"apache/configuration/switcher apache vers l autre port",title:"switcher apache vers l'autre port",description:"Installez Gogs sur votre propre serveur git sur Debian 10 | VPS D\xe9butant | P10",source:"@site/docs/apache/configuration/switcher apache vers l autre port.md",sourceDirName:"apache/configuration",slug:"/apache/configuration/switcher apache vers l autre port",permalink:"/notebook/docs/apache/configuration/switcher apache vers l autre port",draft:!1,editUrl:"https://github.com/scheffershen/notebook/tree/main/docs/apache/configuration/switcher apache vers l autre port.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"mod_proxy_rediriger en tout transparence Apache vers un port sp\xe9cifique",permalink:"/notebook/docs/apache/configuration/mod_proxy_rediriger en tout transparence Apache vers un port sp\xe9cifique"},next:{title:"Changing PHP settings with .htaccess",permalink:"/notebook/docs/apache/htaccess/Changing PHP settings with htaccess"}},i={},c=[{value:"OpenProject Examples",id:"openproject-examples",level:2},{value:"Apache Reverse Proxy Setup",id:"apache-reverse-proxy-setup",level:3}],l={toc:c};function u(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"switcher-apache-vers-lautre-port"},"switcher apache vers l'autre port"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=5ysGZoBJGVU"},"Installez Gogs sur votre propre serveur git sur Debian 10 | VPS D\xe9butant | P10")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ sudo a2enmod proxy\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-apache2.config"},"    ProxyPreserveHost On\n    ProxyRequests off\n      ServerName dummy-host.example.com\n      ServerAlias www.dummy-host.example.com\n      ProxyPass /api/ http://localhost:5000/\n      ProxyPassReverse /api/ http://localhost:5000/\n")),(0,o.kt)("h2",{id:"openproject-examples"},"OpenProject Examples"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.openproject.org/docs/installation-and-operations/installation/docker/"},"OpenProject")),(0,o.kt)("h3",{id:"apache-reverse-proxy-setup"},"Apache Reverse Proxy Setup"),(0,o.kt)("p",null,"For both configurations the following Apache mods are required:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"proxy"),(0,o.kt)("li",{parentName:"ul"},"proxy_http"),(0,o.kt)("li",{parentName:"ul"},"rewrite"),(0,o.kt)("li",{parentName:"ul"},"ssl (optional)")),(0,o.kt)("p",null,"In each case you will create a file ",(0,o.kt)("inlineCode",{parentName:"p"},"/usr/local/apache2/conf/sites/openproject.conf")," with the contents as described in the respective sections."),(0,o.kt)("p",null,"Both configuration examples are based on the following assumptions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"the site is accessed via https"),(0,o.kt)("li",{parentName:"ul"},"certificate and key are located under /etc/ssl/crt/server.{crt, key}"),(0,o.kt)("li",{parentName:"ul"},"the OpenProject docker container\u2019s port 80 is mapped to the docker host\u2019s port 8080")),(0,o.kt)("p",null,"1) Virtual host root"),(0,o.kt)("p",null,"The default scenario is to have OpenProject serve the whole virtual host. This requires no further configuration for the docker container beyond what is described above."),(0,o.kt)("p",null,"Assuming the desired server name is ",(0,o.kt)("inlineCode",{parentName:"p"},"openproject.example.com")," the configuration will look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'<VirtualHost *:80>\n    ServerName openproject.example.com\n\n    RewriteEngine on\n    RewriteCond %{HTTPS} !=on\n    RewriteRule ^/?(.*)$ https://%{SERVER_NAME}/$1 [R,L]\n</VirtualHost>\n\n<VirtualHost *:443>\n    ServerName openproject.example.com\n\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/crt/server.crt\n    SSLCertificateKeyFile /etc/ssl/crt//server.key\n\n    RewriteEngine on\n    RewriteRule "^$" "/" [R,L]\n\n    ProxyRequests off\n\n    <Location "/">\n      RequestHeader set X-Forwarded-Proto \'https\'\n\n      ProxyPreserveHost On\n      ProxyPass http://127.0.0.1:8080/\n      ProxyPassReverse http://127.0.0.1:8080/\n    </Location>\n</VirtualHost>\n')),(0,o.kt)("p",null,"2) Location (subdirectory)"),(0,o.kt)("p",null,"Let\u2019s assume you want OpenProject to run on your host with the server name ",(0,o.kt)("inlineCode",{parentName:"p"},"example.com")," under the subdirectory ",(0,o.kt)("inlineCode",{parentName:"p"},"/openproject"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'<VirtualHost *:80>\n    ServerName example.com\n\n    RewriteEngine on\n    RewriteCond %{HTTPS} !=on\n    RewriteRule ^/?(openproject.*)$ https://%{SERVER_NAME}/$1 [R,L]\n</VirtualHost>\n\n<VirtualHost *:443>\n    ServerName example.com\n\n    SSLEngine on\n    SSLCertificateFile /etc/ssl/crt/server.crt\n    SSLCertificateKeyFile /etc/ssl/crt/server.key\n\n    RewriteEngine on\n    RewriteRule "^/openproject$" "/openproject/" [R,L]\n\n    ProxyRequests off\n\n    <Location "/openproject/">\n      RequestHeader set X-Forwarded-Proto \'https\'\n\n      ProxyPreserveHost On\n      ProxyPass http://127.0.0.1:8080/openproject/\n      ProxyPassReverse http://127.0.0.1:8080/openproject/\n    </Location>\n</VirtualHost>\n')),(0,o.kt)("p",null,"First, find and uncomment the following lines on ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/httpd/conf/httpd.conf")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# LoadModule proxy_module modules/mod_proxy.so\n# LoadModule proxy_http_module modules/mod_proxy_http.so\n# Include conf/extra/httpd-vhosts.conf\n")),(0,o.kt)("p",null,"Then, add the following virtual host to ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/httpd/conf/extra/httpd-vhosts.conf"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<VirtualHost *:80>\n  ProxyPreserveHost On\n  ProxyRequests Off\n  ServerName dummy-host.example.com\n  ServerAlias www.dummy-host.example.com\n  ProxyPass /api/ http://localhost:5000/\n  ProxyPassReverse /api/ http://localhost:5000/\n</VirtualHost>\n")))}u.isMDXComponent=!0}}]);