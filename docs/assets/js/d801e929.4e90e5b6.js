"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[68741],{3905:(e,n,a)=>{a.d(n,{Zo:()=>s,kt:()=>h});var l=a(67294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,l)}return a}function r(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,l,o=function(e,n){if(null==e)return{};var a,l,o={},t=Object.keys(e);for(l=0;l<t.length;l++)a=t[l],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(l=0;l<t.length;l++)a=t[l],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=l.createContext({}),u=function(e){var n=l.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):r(r({},n),e)),a},s=function(e){var n=u(e.components);return l.createElement(p.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return l.createElement(l.Fragment,{},n)}},m=l.forwardRef((function(e,n){var a=e.components,o=e.mdxType,t=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=u(a),m=o,h=d["".concat(p,".").concat(m)]||d[m]||c[m]||t;return a?l.createElement(h,r(r({ref:n},s),{},{components:a})):l.createElement(h,r({ref:n},s))}));function h(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var t=a.length,r=new Array(t);r[0]=m;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[d]="string"==typeof e?e:o,r[1]=i;for(var u=2;u<t;u++)r[u]=a[u];return l.createElement.apply(null,r)}return l.createElement.apply(null,a)}m.displayName="MDXCreateElement"},34366:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>u});var l=a(87462),o=(a(67294),a(3905));const t={slug:"Autoload-avec-composer"},r="php Autoload avec composer",i={unversionedId:"PHP/Autoload/Autoload avec composer",id:"PHP/Autoload/Autoload avec composer",title:"php Autoload avec composer",description:"Sommaire",source:"@site/docs/PHP/Autoload/Autoload avec composer.md",sourceDirName:"PHP/Autoload",slug:"/PHP/Autoload/Autoload-avec-composer",permalink:"/notebook/docs/PHP/Autoload/Autoload-avec-composer",draft:!1,editUrl:"https://github.com/scheffershen/notebook/tree/main/docs/PHP/Autoload/Autoload avec composer.md",tags:[],version:"current",frontMatter:{slug:"Autoload-avec-composer"},sidebar:"tutorialSidebar",previous:{title:"PHP",permalink:"/notebook/docs/category/php-1"},next:{title:"composer-cli (==npm==yarn==apt==pip)",permalink:"/notebook/docs/PHP/Composer/Composer-cli"}},p={},u=[{value:"Sommaire",id:"sommaire",level:2},{value:"What is autoloading?",id:"what-is-autoloading",level:2},{value:"Composer == npm, yarn, pip, apt",id:"composer--npm-yarn-pip-apt",level:2},{value:"1 - Initier le projet avec composer :",id:"1---initier-le-projet-avec-composer-",level:2},{value:"2 - Autoload PSR-4 = 3 - Cr\xe9ation du fichier vendor/autoload.php",id:"2---autoload-psr-4--3---cr\xe9ation-du-fichier-vendorautoloadphp",level:2},{value:"Autoload examples",id:"autoload-examples",level:2},{value:"Chargement de l&#39;autooad (index.php)",id:"chargement-de-lautooad-indexphp",level:2},{value:"Types of autoloading",id:"types-of-autoloading",level:2},{value:"1. Classmap",id:"1-classmap",level:3},{value:"2. PSR-0",id:"2-psr-0",level:3},{value:"3. PSR-4",id:"3-psr-4",level:3},{value:"4. Files",id:"4-files",level:3},{value:"Note on Classmap and PSR-4",id:"note-on-classmap-and-psr-4",level:3},{value:"chamilo-lms composer.json example",id:"chamilo-lms-composerjson-example",level:2},{value:"claroline-lms composer.json example",id:"claroline-lms-composerjson-example",level:2},{value:"Resources",id:"resources",level:2}],s={toc:u};function d(e){let{components:n,...a}=e;return(0,o.kt)("wrapper",(0,l.Z)({},s,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"php-autoload-avec-composer"},"php Autoload avec composer"),(0,o.kt)("h2",{id:"sommaire"},"Sommaire"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"##composer"},"Composer")),(0,o.kt)("li",{parentName:"ul"},"1 - Initier le projet avec composer :"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"##psr-1-vs-classmap"},"psr-4 vs classmap")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"##resources"},"Resources")),(0,o.kt)("li",{parentName:"ul"},"[autoload comparaison entre php, javascript, python]")),(0,o.kt)("h2",{id:"what-is-autoloading"},"What is autoloading?"),(0,o.kt)("p",null,"Autoloading means the automatic loading of the files required for your project/application."),(0,o.kt)("h2",{id:"composer--npm-yarn-pip-apt"},"Composer == npm, yarn, pip, apt"),(0,o.kt)("p",null,"Composer est un gestionnaire de d\xe9pendances pour php. (Composer is an application-level dependency manager for PHP. )"),(0,o.kt)("p",null,"Composer permet notamment :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"de d\xe9clarer les librairies ou packages dont le projet d\xe9pend,"),(0,o.kt)("li",{parentName:"ul"},"de g\xe9rer les installation et les mises \xe0 jour de ces libraires,"),(0,o.kt)("li",{parentName:"ul"},'de mettre en place facilement un "autoloader" afin que nous, d\xe9veloppeurs php, n\'ayons plus \xe0 nous soucier d\'importer des fichiers via des "include" ou des "require".')),(0,o.kt)("h2",{id:"1---initier-le-projet-avec-composer-"},"1 - Initier le projet avec composer :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ composer init\n")),(0,o.kt)("h2",{id:"2---autoload-psr-4--3---cr\xe9ation-du-fichier-vendorautoloadphp"},"2 - Autoload PSR-4 = 3 - Cr\xe9ation du fichier vendor/autoload.php"),(0,o.kt)("p",null,"Regenerate the autoloader file (Pour mettre \xe0 jour l'auto-chargement de Composer :)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ composer dump-autoload\n")),(0,o.kt)("p",null,"Cela va cr\xe9er le fichier autoload.php dans le r\xe9pertoire vendor."),(0,o.kt)("h2",{id:"autoload-examples"},"Autoload examples"),(0,o.kt)("p",null,'Sous la cl\xe9 psr-4, on d\xe9finit un "mappage" des espaces de noms aux chemins, par rapport \xe0 la racine du package'),(0,o.kt)("p",null,"Lors du chargement automatique d'une classe comme Foo","\\","Bar","\\","Baz, un pr\xe9fixe d'espace de noms Foo","\\"," pointant vers un r\xe9pertoire src/ signifie que le chargeur automatique recherchera un fichier nomm\xe9 src/Bar/Baz.php et l'inclura s'il est pr\xe9sent. "),(0,o.kt)("p",null,"Les pr\xe9fixes d'espace de noms doivent se terminer par ","\\"," pour \xe9viter les conflits entre pr\xe9fixes similaires."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    "autoload": {\n        "psr-4": {\n            "App\\\\": "src/",\n            "App\\\\Services\\\\": "app/services"\n        }\n    },\n    "autoload-dev": {\n        "psr-4": {\n            "App\\\\Tests\\\\": "tests/"\n        }\n    },\n')),(0,o.kt)("h2",{id:"chargement-de-lautooad-indexphp"},"Chargement de l'autooad (index.php)"),(0,o.kt)("p",null,"Dans le fichier principal de votre projet, index.php par convention, ajouter la ligne suivante :"),(0,o.kt)("p",null,"index.php"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"require 'vendor/autoload.php';\n")),(0,o.kt)("h2",{id:"types-of-autoloading"},"Types of autoloading"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Classmap"),(0,o.kt)("li",{parentName:"ol"},"PSR-0"),(0,o.kt)("li",{parentName:"ol"},"PSR-4"),(0,o.kt)("li",{parentName:"ol"},"Files")),(0,o.kt)("h3",{id:"1-classmap"},"1. Classmap"),(0,o.kt)("p",null,"Classmap as its name implies creates a mapping of all the classes inside the specified directories into a single key => value array, which can be found in the generated file ",(0,o.kt)("inlineCode",{parentName:"p"},"vendor/composer/autoload_classmap.php")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    "autoload": {\n        "classmap": ["src/", "lib/", "Something.php"]\n    }\n    // ou\n    "autoload": {\n        "classmap": ["Behavioral", "Creational", "Structural", "More"]\n    }\n')),(0,o.kt)("h3",{id:"2-psr-0"},"2. PSR-0"),(0,o.kt)("p",null,"This is the PSR standard for autoloading files before PSR-4 and it is now Deprecated."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "autoload": {\n        "psr-0": {\n            "Acme\\\\Foo\\\\": "src/",\n            "Vendor\\\\Namespace\\\\": "src/",\n            "Vendor_Namespace_": "src/"\n        }\n    }\n}\n')),(0,o.kt)("p",null,"All PSR-0 references are combined into a single key => value array, which can be found in the generated file ",(0,o.kt)("inlineCode",{parentName:"p"},"vendor/composer/autoload_namespaces.php"),"."),(0,o.kt)("p",null,"For example, ",(0,o.kt)("inlineCode",{parentName:"p"},"Acme\\Foo\\Bar")," would resolve to ",(0,o.kt)("inlineCode",{parentName:"p"},"src/Acme/Foo/Bar.php"),". and ",(0,o.kt)("inlineCode",{parentName:"p"},"Acme_Foo_Bar")," would also be resolved to ",(0,o.kt)("inlineCode",{parentName:"p"},"src/Acme/Foo/Bar.php"),"."),(0,o.kt)("h3",{id:"3-psr-4"},"3. PSR-4"),(0,o.kt)("p",null,"PSR-4 is currently the recommended way of autoloading since it offers greater ease of use."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "autoload": {\n        "psr-4": {\n            "Acme\\\\Foo\\\\": "src/",\n            "Vendor\\\\Namespace\\\\": ""\n        }\n    }\n}\n')),(0,o.kt)("p",null,"Unlike PSR-0 underscores will not be converted to ",(0,o.kt)("inlineCode",{parentName:"p"},"DIRECTORY_SEPARATOR")," and the namespace prefix is not present in the path."),(0,o.kt)("p",null,"For example, ",(0,o.kt)("inlineCode",{parentName:"p"},"Acme\\Foo\\Bar")," would resolve to ",(0,o.kt)("inlineCode",{parentName:"p"},"src/Bar.php"),"."),(0,o.kt)("p",null,"All the PSR-4 references are combined, during install/update into a single key => value array, which can be found at ",(0,o.kt)("inlineCode",{parentName:"p"},"vendor/composer/autoload_psr4.php"),"."),(0,o.kt)("h3",{id:"4-files"},"4. Files"),(0,o.kt)("p",null,"Classmap, ",(0,o.kt)("inlineCode",{parentName:"p"},"PSR-0"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"PSR-4")," deal with classes only. If you want to autoload functions, you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"files")," autoloading. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "autoload": {\n        "files": ["src/helpers.php"]\n    }\n}\n')),(0,o.kt)("h3",{id:"note-on-classmap-and-psr-4"},"Note on Classmap and PSR-4"),(0,o.kt)("p",null,"Classmap autoloading is the fastest among autoloaders since it loads classes from the prebuilt array. But the problem with classmap is that you need to regenerate the classmap array every time you create a new class file. So in the development environment PSR-4 autoloading will be the most suited one."),(0,o.kt)("h2",{id:"chamilo-lms-composerjson-example"},"chamilo-lms composer.json example"),(0,o.kt)("p",null,"url: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/chamilo/chamilo-lms.git"},"https://github.com/chamilo/chamilo-lms.git")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    "autoload": {\n        "psr-4": {\n            "Chamilo\\\\": "src/"\n        },\n        "files": [\n            "public/legacy.php"\n        ],\n        "classmap": [\n            "public/main/auth",\n            "public/main/admin",\n            "public/main/course_description",\n            "public/main/dropbox",\n            "public/main/exercise",\n            "public/main/gradebook/lib",\n            "public/main/lp",\n            "public/main/inc/lib",\n            "public/plugin",\n            "public/main/install",\n            "public/main/survey"\n        ]\n    },\n    "autoload-dev": {\n        "psr-4": {\n            "Chamilo\\\\Tests\\\\": "tests/"\n        }\n    },\n')),(0,o.kt)("h2",{id:"claroline-lms-composerjson-example"},"claroline-lms composer.json example"),(0,o.kt)("p",null,"url: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/claroline/Distribution.git"},"https://github.com/claroline/Distribution.git")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'    "autoload": {\n        "psr-4": {\n            "Claroline\\\\CoreBundle\\\\": "main/core",\n            "Claroline\\\\AppBundle\\\\": "main/app",\n            "Claroline\\\\AuthenticationBundle\\\\": "main/authentication",\n            "Claroline\\\\BundleRecorder\\\\": "main/recorder",\n            "Claroline\\\\InstallationBundle\\\\": "main/installation",\n            "Claroline\\\\MigrationBundle\\\\": "main/migration",\n            "Claroline\\\\KernelBundle\\\\": "main/kernel",\n            "Claroline\\\\ThemeBundle\\\\": "main/theme",\n            "Claroline\\\\AgendaBundle\\\\": "plugin/agenda",\n            "Claroline\\\\AnalyticsBundle\\\\": "plugin/analytics",\n            "Claroline\\\\AnnouncementBundle\\\\": "plugin/announcement",\n            "Claroline\\\\ForumBundle\\\\": "plugin/forum",\n            "Claroline\\\\HistoryBundle\\\\": "plugin/history",\n            "Claroline\\\\HomeBundle\\\\": "plugin/home",\n            "Claroline\\\\ImagePlayerBundle\\\\": "plugin/image-player",\n            "Claroline\\\\MessageBundle\\\\": "plugin/message",\n            "Icap\\\\NotificationBundle\\\\": "plugin/notification",\n            "Claroline\\\\PdfPlayerBundle\\\\": "plugin/pdf-player",\n            "Claroline\\\\RssBundle\\\\": "plugin/rss",\n            "Claroline\\\\ScormBundle\\\\": "plugin/scorm",\n            "Claroline\\\\TagBundle\\\\": "plugin/tag",\n            "Claroline\\\\TeamBundle\\\\": "plugin/team",\n            "Claroline\\\\TextPlayerBundle\\\\": "plugin/text-player",\n            "Claroline\\\\VideoPlayerBundle\\\\": "plugin/video-player",\n            "Claroline\\\\WebResourceBundle\\\\": "plugin/web-resource",\n            "HeVinci\\\\FavouriteBundle\\\\": "plugin/favourite",\n            "HeVinci\\\\CompetencyBundle\\\\": "plugin/competency",\n            "HeVinci\\\\UrlBundle\\\\": "plugin/url",\n            "Icap\\\\BlogBundle\\\\": "plugin/blog",\n            "Icap\\\\SocialmediaBundle\\\\": "plugin/social-media",\n            "Icap\\\\WikiBundle\\\\": "plugin/wiki",\n            "Icap\\\\FormulaPluginBundle\\\\": "plugin/formula",\n            "Innova\\\\PathBundle\\\\": "plugin/path",\n            "Claroline\\\\DevBundle\\\\": "main/dev",\n            "UJM\\\\ExoBundle\\\\": "plugin/exo",\n            "Icap\\\\LessonBundle\\\\": "plugin/lesson",\n            "Claroline\\\\ClacoFormBundle\\\\": "plugin/claco-form",\n            "UJM\\\\LtiBundle\\\\": "plugin/lti",\n            "Icap\\\\BibliographyBundle\\\\": "plugin/bibliography",\n            "Claroline\\\\DropZoneBundle\\\\": "plugin/drop-zone",\n            "Claroline\\\\PlannedNotificationBundle\\\\": "plugin/planned-notification",\n            "Claroline\\\\LinkBundle\\\\": "plugin/link",\n            "Claroline\\\\OpenBadgeBundle\\\\": "plugin/open-badge",\n            "Claroline\\\\SamlBundle\\\\": "plugin/saml",\n            "Claroline\\\\SlideshowBundle\\\\": "plugin/slideshow",\n            "Claroline\\\\AudioPlayerBundle\\\\": "plugin/audio-player",\n            "Claroline\\\\CursusBundle\\\\": "plugin/cursus",\n            "Claroline\\\\BookingBundle\\\\": "plugin/booking",\n            "Claroline\\\\BigBlueButtonBundle\\\\": "integration/big-blue-button"\n        }\n    },\n')),(0,o.kt)("h2",{id:"resources"},"Resources"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://jinoantony.com/blog/how-composer-autoloads-php-files"},"https://jinoantony.com/blog/how-composer-autoloads-php-files"))))}d.isMDXComponent=!0}}]);